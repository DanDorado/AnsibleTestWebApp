#Playbook for online store

---

-
  name: 'Set up the Prerequisites of e-commerce'
  hosts: targets
  tasks:
    
    - name: 'Initialise'
      debug:
        msg: 'Logging into {{  ansible_host  }} with {{  ansible_user  }}'

    - name: 'Install Firewalld'
      yum:
        name: firewalld
        state: present
      become: true
      become_method: sudo

    - name: 'Start Firewalld'
      service: service=firewalld state=started
      become: true
      become_method: sudo

    - name: 'Enable firewalld on system startup'
      command: systemctl enable firewalld
      become: true
      become_method: sudo

    - name: 'Install MariaDB'
      yum:
        name: mariadb-server
        state: present
      become: true
      become_method: sudo

    - name: 'Start Mariadb'
      service: service=mariadb state=started
      become: true
      become_method: sudo

    - name: 'Enable Mariadb on system startup'
      command: systemctl enable mariadb
      become: true
      become_method: sudo

    - name: 'Configure Firewall for Database'
      command: firewall-cmd --permanent --zone=public --add-port=3306/tcp
      become: true
      become_method: sudo
    
    - command: firewall-cmd --reload
      become: true
      become_method: sudo


-
  name: 'Create MySql database'
  hosts: targets
  tasks:
    - name: 'Log into mysql'
      command: mysql -u root -p
      

